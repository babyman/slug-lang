var {*} = import(
    "slug.std"
);

@export
var assert = fn(a, msg = nil) {
    if ( a /> type() == BOOLEAN_TYPE && !a ) {
        if ( !msg ) {
            msg = "{{a}} ({{a /> type()}}) is not true";
        }
        throw {type: "AssertionError", msg: msg}
    }
}

@export
var assertTrue = assert;

@export
var assertFalse = fn(a, msg = nil) {
    assert( !a, msg);
}


@export
var assertEqual = fn(value, expected, msg = nil) {
    if ( value != expected ) {
        if ( !msg ) {
            msg = "'{{value}}' is not equal to '{{expected}}'";
        }
        throw {type: "AssertionError", msg: msg}
    }
    value
}


@export
var assertEqual = fn(@list value, @list expected, msg = nil) {
    if ( !(value == expected || equals(value, expected)) ) {
        if ( !msg ) {
            msg = "List '{{value}}' is not equal to '{{expected}}'";
        }
        throw {type: "AssertionError", msg: msg}
    }
    value
}

@export
var assertEqual = fn(@map value, @map expected, msg = nil) {
    if ( !(value == expected || equals(value, expected)) ) {
        if ( !msg ) {
            msg = "Map '{{value}}' is not equal to '{{expected}}'";
        }
        throw {type: "AssertionError", msg: msg}
    }
    value
}


@export
var fail = fn(msg = nil) {
    if ( !msg ) {
        msg = "Test failed!";
    }
    throw {type: "AssertionError", msg: msg}
}
