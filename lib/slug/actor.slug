
@export
foreign spawn = fn(@fun f, ...args); // -> pid


@export
foreign spawnSrc = fn(@str src, @list allowedImports = []); // -> pid


@export
foreign self = fn(); // -> pid


@export
foreign send = fn(@num pid, msg); // -> pid


@export
foreign receive = fn(@num timeout_ms = 0); // -> msg | nil


@export
foreign terminate = fn(@num pid);


@export
var spawnFn = fn(@fun f, ...args) {
	val replyTo = self();
	spawn(fn() {
		send(replyTo, f(...args));
	});
}

