var {*} = import(
	"slug.std",
	"slug.list",
	"slug.actor",
	"slug.test",
);

//
// register a new actor with a name
//
var sumId = spawnFn(fn(...vs) { vs /> reduce(0, fn(a, b) { a + b }) })
	 /> register("sum");

//
// look the actor up by name and send some messages
//
lookup("sum")
	/> assertEqual(sumId)
	/> send([1, 2])
	/> send([2, 3, 4])
	/> send([1])
	/> send(109)

//
// collect the results, sort them and assert they are correct
//
receiveN(4) /> sort 
	/> assertEqual([1, 3, 9, 109])

//
// replace the existing name actor and send the same messages
//
var subId = spawnFn(fn(...vs) { vs /> reduce(0, fn(a, b) { a - b }) })
	/> registerReplace("sum")
	/> send([1, 2])
	/> send([2, 3, 4])
	/> send([1])
	/> send(109)

//
// collect the results, sort them and assert they are correct
//
receiveN(40) /> sort 
	/> assertEqual([-109, -9, -3, -1])

